<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<title>Faceted course search</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="my_js.js"></script>
<script src="input.js"></script>
<script src="makeList.js"></script>
<script src='https://kit.fontawesome.com/a076d05399.js'></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

  <style>

div.myboc {
  border: 33px solid transparent;
  background: #ffa57d;
  border-top-color: #ffa57d;
  border-radius: 5px;
  margin-bottom: -33px;
}
div.mybocs {
  border: 10px solid transparent;
  /* background: #A7A7A7; */
  /* border-top-color: #A7A7A7; */
  border-radius: 5px;
  margin-bottom: -33px;
}

div.row {
 display:inline-block;
 width: 175px;
 border: 10px solid transparent;
 margin-left: 16.5px;
 /* background: #A7A7A7; */
 /* border-top-color: #A7A7A7; */

}
div.rows {
 display:inline-block;
 width: 220px;
 border: 10px solid transparent;
 margin-left: 16.5px;
 /* background: #A7A7A7; */
 /* border-top-color: #A7A7A7; */

}


  </style>
</head>
<body>
  <br>
  <h1 class="container">Search courses</h1>
  <div class="input-group mt-3 mb-3 container">
    <div class="input-group-prepend">
    <input type="text" id="myText" class="form-control" value = "" placeholder="Search">
  </div>
<br>
<br>
<p class ="container"></p>
  <div class="form-check container">
    <label class="form-check-label">
      <input type="checkbox" class="form-check-input" id="myCheck">Show only courses taught in English
    </label>
      <br>
    <label class="form-check-label">
      <input type="checkbox" class="form-check-input" id="myCheck2">Show also doctoral courses
    </label>
  </div>

  <br>


<br>

<br>
<div class="container">
<button id="mybutton" type="submit" onclick="getList(); filters(); printed(); bubbles()">Get list</button>

<br>
<br>

<div class = "mybocs" id="myChecking"></div>
<br>
<br>
<canvas id="myChart"></canvas>
<script>
  var chart=null;
function bubbles(){

  if(chart!=null){
    chart.destroy();
  }

  var ctx = document.getElementById('myChart').getContext('2d');

  var courses = getList();
  var list_names = [];
  var list_credits = [];
  var list_levels = [];
  var list_period = [];
  var lkm = 20;
  var bsc_level = 'rgb(255, 99, 132)';
  var msc_level = 'rgb(100, 100, 255 )';
  var advanced = "rgb(92, 22, 57)";
  var basics = "rgb(56, 241, 233)";
  var period1 = 1;
  var period2 = 2;
  var period3 = 3;
  var period4 = 4;
  var period5 = 5;
  var oter = 4.5;
  var aut = 1.5;
  var spr = 3.5;
  var sum = 5.5;

  var y_akseli = [];
  for (var h = 0; h < lkm; h++) {
    // var arvo2 = Math.floor(Math.random() * Math.floor(5));
    var arvo2 = Math.random();
    var arvo = arvo2*courses[h]["name"].length;
    y_akseli.push(arvo2);
  }

  for(i = 0;i < lkm; i++){
    list_names.push(courses[i]["name"]);
    list_credits.push(courses[i]["credit"]);
    if (courses[i]["level"].includes("Bachelor")){
      list_levels.push(bsc_level);
    }
    else if (courses[i]["level"].includes("Master")){
      list_levels.push(msc_level);
    }
    else if (courses[i]["level"].includes("Advanced")){
      list_levels.push(advanced);
    }
    if (courses[i]["period"].includes("Autumn")){
      list_period.push(aut);
    }
    else if (courses[i]["period"].includes("Spring")){
      list_period.push(spr);
    }
    else if (courses[i]["period"].includes("Summer") || courses[i]["period"].includes("summer")){
      list_period.push(sum);
    }
    else if (courses[i]["period"].includes("III") && courses[i]["period"].includes("IV")){
      list_period.push(3.5);
    }
    else if (courses[i]["period"].includes("III") && courses[i]["period"].includes("V")){
      list_period.push(3.8);
    }
    else if (courses[i]["period"].includes("I") && courses[i]["period"].includes("II")){
      list_period.push(1.2);
    }
    else if (courses[i]["period"].includes("I") && courses[i]["period"].includes("III")){
      list_period.push(1.8);
    }
    else if (courses[i]["period"].includes("V")){
      list_period.push(period5);
    }
    else if (courses[i]["period"].includes("IV")){
      list_period.push(period4);
    }
    else if (courses[i]["period"].includes("III")){
      list_period.push(period3);
    }
    else if (courses[i]["period"].includes("II")){
      list_period.push(period2);
    }
    else if (courses[i]["period"].includes("I")){
      list_period.push(period1);
    }
    else {
      list_levels.push(basics);
      list_period.push(Math.random(5));
    }
  }

  var chart = new Chart(ctx, {
      type: 'bubble',
      data: {
          datasets: [{
              label: list_names[0],
              backgroundColor: list_levels[0],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[0],
                y: y_akseli[0],
                r: list_credits[0]*10
              }]

          },
          {
              label: list_names[1],
              backgroundColor: list_levels[1],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[1],
                y: y_akseli[1],
                r: list_credits[1]*10
              }]
          },
          {
              label: list_names[2],
              backgroundColor: list_levels[2],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[2],
                y: y_akseli[2],
                r: list_credits[2]*10
              }]
          },
          {
              label: list_names[3],
              backgroundColor: list_levels[3],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[3],
                y: y_akseli[3],
                r: list_credits[3]*10
              }]
          },
          {
              label: list_names[4],
              backgroundColor: list_levels[4],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[4],
                y: y_akseli[4],
                r: list_credits[4]*10
              }]
          },
          {
              label: list_names[5],
              backgroundColor: list_levels[5],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[5],
                y: y_akseli[5],
                r: list_credits[5]*10
              }]
          },
          {
              label: list_names[6],
              backgroundColor: list_levels[6],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[6],
                y: y_akseli[6],
                r: list_credits[6]*10
              }]
          },
          {
              label: list_names[7],
              backgroundColor: list_levels[7],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[7],
                y: y_akseli[7],
                r: list_credits[7]*10
              }]
          },
          {
              label: list_names[8],
              backgroundColor: list_levels[8],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[8],
                y: y_akseli[8],
                r: list_credits[8]*10
              }]
          },
          {
              label: list_names[9],
              backgroundColor: list_levels[9],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[9],
                y: y_akseli[9],
                r: list_credits[9]*10
              }]
          },
          {
              label: list_names[10],
              backgroundColor: list_levels[10],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[10],
                y: y_akseli[10],
                r: list_credits[10]*10
              }]
          },
          {
              label: list_names[11],
              backgroundColor: list_levels[11],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[11],
                y: y_akseli[1],
                r: list_credits[1]*10
              }]
          },
          {
              label: list_names[12],
              backgroundColor: list_levels[12],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[12],
                y: y_akseli[12],
                r: list_credits[12]*10
              }]
          },
          {
              label: list_names[13],
              backgroundColor: list_levels[13],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[13],
                y: y_akseli[13],
                r: list_credits[13]*10
              }]
          },
          {
              label: list_names[14],
              backgroundColor: list_levels[14],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[14],
                y: y_akseli[14],
                r: list_credits[14]*10
              }]
          },
          {
              label: list_names[15],
              backgroundColor: list_levels[15],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[15],
                y: y_akseli[15],
                r: list_credits[15]*10
              }]
          },
          {
              label: list_names[16],
              backgroundColor: list_levels[16],
              borderColor: 'rgb(30, 40, 132)',
              data: [{
                x: list_period[16],
                y: y_akseli[16],
                r: list_credits[16]*10
              }]
          }]
      },

      // Configuration options go here
      options: {
          layout: {
              padding: {
                  left: 60,
                  right: 60,
                  top: 60,
                  bottom:60
              }
          },
          legend: {
              display: false,
              labels: {
                  fontColor: 'rgb(255, 99, 132)'
              }
          },
          scales: {
            yAxes: [{
              display: false,
              gridLines: {
                display: false,
              },
            }],
            xAxes: [{
              ticks: {
                    // Include a dollar sign in the ticks
                    callback: function(value,index, values) {
                        return 'Period ' + value;
                    }
                },
              label: 'timescale',
              gridLines: {
                display: false,
              },
            }]
          },
          onClick: (evt, item) => {
              let index = item[0]["_index"];
              let fruit = item[0]["_chart"].data.labels[index];
              let votes = item[0]["_chart"].data.datasets[0].data[index];
          }
      }
  });

}
</script>

<!-- <p id="newlist"></p> -->

<!-- <button onclick="makeList()">Make list</button> -->
<br>
<br>
<!-- <div cellpadding="2" cellspacing="2" border="0" bgcolor="#dfdfdf" width="110%" align="left"> -->
    <div class = "myboc" id="tableData"></div>

<!-- </div> -->
</div>
<p></p>

</body>
</html>
